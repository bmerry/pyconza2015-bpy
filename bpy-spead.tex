\documentclass{beamer}
\mode<presentation>
{
  \usetheme{Berkeley}
  \setbeamertemplate{footline}[frame number]
  \setbeamercovered{transparent}
}
\usepackage[english]{babel}
\usepackage[latin1]{inputenc}
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage{tikz}
\usepackage{booktabs}
\usepackage{listings}
\usepackage[binary-units=true]{siunitx}
\usepackage{amsmath}
\usepackage{underscore}
\definecolor{lstpurple}{rgb}{0.5,0,0.35}
\definecolor{lstred}{rgb}{0.6,0,0}
\definecolor{lstgreen}{rgb}{0.25,0.5,0.35}
\definecolor{lstblue}{rgb}{0.25,0.35,0.75}
\lstset{language = Python,
    showstringspaces = false,
    columns = flexible,
    basicstyle = \ttfamily\footnotesize,
    keywordstyle = \color{lstpurple},
    keywordstyle = [2]\color{lstblue},
    commentstyle = \color{lstgreen},
    stringstyle = \color{lstred},
    numbers=left,numberstyle=\tiny,numbersep=1ex
}

\title[Boost.Python]{How I learn to stop worrying and love Boost.Python}

\subtitle{An adventure in high-performance networking}

\author{Bruce Merry}
% - Give the names in the same order as the appear in the paper.
% - Use the \inst{?} command only if the authors have different
%   affiliation.

\institute[SKA SA]{SKA South Africa}

\date{PyCon ZA 2015}

% If you have a file called "university-logo-filename.xxx", where xxx
% is a graphic format that can be processed by latex or pdflatex,
% resp., then you can add a logo as follows:

% \pgfdeclareimage[height=0.5cm]{university-logo}{university-logo-filename}
% \logo{\pgfuseimage{university-logo}}



% Delete this, if you do not want the table of contents to pop up at
% the beginning of each subsection:
\AtBeginSubsection[]
{
  \begin{frame}<beamer>{Outline}
    \tableofcontents[currentsection,currentsubsection]
  \end{frame}
}


% If you wish to uncover everything in a step-wise fashion, uncomment
% the following command: 

%\beamerdefaultoverlayspecification{<+->}


\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Outline}
  \tableofcontents
  % You might wish to add the option [pausesections]
\end{frame}

\section{Motivation}

\subsection{MeerKAT}

\subsection{SPEAD}

\begin{frame}{High-performance Networking}
  \alert{S}treaming \alert{P}rotocol for \alert{E}xchange of
  \alert{A}stronomical \alert{D}ata
  \begin{itemize}
    \item Generic, not astronomy-specific at all
    \item Used in MeerKAT for data (and occasionally metadata)
    \item Lossy one-way UDP transmission, multicast-friendly
  \end{itemize}
\end{frame}

\begin{frame}{Concepts}
  \begin{description}
    \item[Heap] Unit of transmission. Contains multiple items.
    \item[Item] Data in a numpy array.
    \item[Packet] UDP packet
  \end{description}
  Heaps are broken down into multiple packets
\end{frame}

\begin{frame}{Example}
  Correlator heaps at \SI{2}{\Hz}:
  \begin{itemize}
    \item \texttt{xeng_raw} $8320\times 32768\times 2\times \text{int32}$
    \item \texttt{timestamp} int
  \end{itemize}
  Each \SI{2}{\gibi\byte} heap is split into \SI{9}{\kilo\byte} packets.

  \pause
  Total rate is \SI{35}{Gbps} / \SI{475}{Kpps}.

  \pause
  In reality, will split this into several streams.
\end{frame}

\begin{frame}{Not Your Average High-Speed Networking}
  \begin{itemize}
    \item Large packets (MTU 9200)
    \item Small number of flows
    \item Bandwidth matters, latency doesn't
  \end{itemize}
\end{frame}

\begin{frame}{Just To Make It Interesting}
  I had some goals:
  \begin{itemize}
    \item Run without root privileges
    \item Run on Linux and OS X
  \end{itemize}
\end{frame}

% Add a slide giving examples of how sensitive things are
\section{Talking to C++}

\subsection{An Example C++ Library}

\begin{frame}[fragile=singleslide]{Code}
\begin{lstlisting}[language=c++]
namespace petshop
{

class Parrot
{
private:
    int volts;
public:
    void voom();
    void set_volts(int volts);
    int get_volts() const;
};

}
\end{lstlisting}
\end{frame}

\subsection{Python C API}

% - The problem
%   - MeerKAT
%   - SPEAD
%   - High performance networking, but different
% - The approach
%   - Why Python
%     - we're a Python shop; protocol is based on numpy
%   - Why C++ (and how hard is it really?)
% - Possible solutions
%   - Pure Python
%   - ctypes, cffi
%   - Cython
%     - Show the compiler error
%   - Python C API
%     - Yuck!
%   - Boost.Python
%     - Show a noddy example
%     - Downside: a runtime system library dependency
% - The interesting stuff
%   - GIL
%     - GIL background
%   - Lifetime management (custodian and ward)
%   - KeyboardInterrupt
%   - asyncio
%   - logging
%   - exceptions
%   - bytestring conversion

\section*{Summary}

\begin{frame}{Summary}
  \begin{itemize}
    \item Fantastic for integrating C++ classes
    \item Can drop down to Python C API when needed
    \item Introduces a system library dependency
  \end{itemize}
\end{frame}

\end{document}
